{"remainingRequest":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js!D:\\wwwroot\\vue-admin-template\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\wwwroot\\vue-admin-template\\src\\store\\modules\\permission.js","mtime":1645944486929},{"path":"D:\\wwwroot\\vue-admin-template\\babel.config.js","mtime":1645316547015},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645316876002},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1645316878558}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovd3d3cm9vdC92dWUtYWRtaW4tdGVtcGxhdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IHsgYXN5bmNSb3V0ZXMsIGNvbnN0YW50Um91dGVzIH0gZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgZXhwb3J0RGVmYXVsdFJvdXRlciBmcm9tICJAL3JvdXRlci9leHBvcnQtbW9kdWxlcy1yb3V0ZXIiOwovKioKICogVXNlIG1ldGEucm9sZSB0byBkZXRlcm1pbmUgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgcGVybWlzc2lvbgogKiBAcGFyYW0gcm9sZXMKICogQHBhcmFtIHJvdXRlCiAqLwoKZnVuY3Rpb24gaGFzUGVybWlzc2lvbihyb2xlcywgcm91dGUpIHsKICBpZiAocm91dGUubWV0YSAmJiByb3V0ZS5tZXRhLnJvbGVzKSB7CiAgICByZXR1cm4gcm9sZXMuc29tZShmdW5jdGlvbiAocm9sZSkgewogICAgICByZXR1cm4gcm91dGUubWV0YS5yb2xlcy5pbmNsdWRlcyhyb2xlKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KLyoqCiAqIEZpbHRlciBhc3luY2hyb25vdXMgcm91dGluZyB0YWJsZXMgYnkgcmVjdXJzaW9uCiAqIEBwYXJhbSByb3V0ZXMgYXN5bmNSb3V0ZXMKICogQHBhcmFtIHJvbGVzCiAqLwoKCmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcyhyb3V0ZXMsIHJvbGVzKSB7CiAgdmFyIHJlcyA9IFtdOwogIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgdmFyIHRtcCA9IF9vYmplY3RTcHJlYWQoe30sIHJvdXRlKTsKCiAgICBpZiAoaGFzUGVybWlzc2lvbihyb2xlcywgdG1wKSkgewogICAgICBpZiAodG1wLmNoaWxkcmVuKSB7CiAgICAgICAgdG1wLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXModG1wLmNoaWxkcmVuLCByb2xlcyk7CiAgICAgIH0KCiAgICAgIHJlcy5wdXNoKHRtcCk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlczsKfQp2YXIgc3RhdGUgPSB7CiAgcm91dGVzOiBbXSwKICBhZGRSb3V0ZXM6IFtdCn07CnZhciBtdXRhdGlvbnMgPSB7CiAgU0VUX1JPVVRFUzogZnVuY3Rpb24gU0VUX1JPVVRFUyhzdGF0ZSwgcm91dGVzKSB7CiAgICBzdGF0ZS5hZGRSb3V0ZXMgPSByb3V0ZXM7CiAgICBzdGF0ZS5yb3V0ZXMgPSBjb25zdGFudFJvdXRlcy5jb25jYXQocm91dGVzKTsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIGdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiBnZW5lcmF0ZVJvdXRlcyhfcmVmLCByZXMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICB2YXIgYWNjZXNzZWRSb3V0ZXM7CiAgICAgIHZhciByb2xlcyA9IHJlc1sncm9sZXMnXTsKCiAgICAgIGlmIChyb2xlcy5pbmNsdWRlcygnYWRtaW5pc3RyYXRvcicpKSB7CiAgICAgICAgY29uc29sZS5sb2coJ+OAkC4vc3JjL3N0b3JlL21vZHVsZXMvcGVybWlzc2lvbi5qc+OAkTXjgIHlvZPliY3nlKjmiLfmmK/otoXnuqfnrqHnkIblkZjop5LoibLvvIzmi6XmnInlhajpg6jmnYPpmZDvvJonLCBhc3luY1JvdXRlcyk7CiAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSBhc3luY1JvdXRlcyB8fCBbXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygn44CQLi9zcmMvc3RvcmUvbW9kdWxlcy9wZXJtaXNzaW9uLmpz44CRNeOAgeW9k+WJjeeUqOaIt+S4jeaYr+i2hee6p+euoeeQhuWRmOinkuiJsu+8jOmcgOimgei/h+a7pOi3r+eUseihqO+8micsIGFzeW5jUm91dGVzKTsKICAgICAgICBhY2Nlc3NlZFJvdXRlcyA9IGZpbHRlckFzeW5jUm91dGVzKGFzeW5jUm91dGVzLCByb2xlcyk7CiAgICAgIH0KCiAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKTsKICAgICAgY29uc29sZS5sb2coJ+OAkC4vc3JjL3N0b3JlL21vZHVsZXMvcGVybWlzc2lvbi5qc+OAkTbjgIHlsIbov4fmu6TlkI7nmoTot6/nlLHlrZjlhaUgdnVleCBzdGF0ZSBTRVRfUk9VVEVT77yaJywgYWNjZXNzZWRSb3V0ZXMpOwogICAgICByZXNvbHZlKGFjY2Vzc2VkUm91dGVzKTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTsKY29uc29sZS5sb2coJz09PnZ1ZXjot6/nlLFbLi9zcmMvc3RhdGUvbW9kdWxlcy9wZXJtaXNzaW9uLmpzXScpOw=="},{"version":3,"sources":["D:/wwwroot/vue-admin-template/src/store/modules/permission.js"],"names":["asyncRoutes","constantRoutes","exportDefaultRouter","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","children","push","state","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","commit","Promise","resolve","accessedRoutes","console","log","namespaced"],"mappings":";;;;;;AAAA,SAASA,WAAT,EAAsBC,cAAtB,QAA4C,UAA5C;AACA,OAAOC,mBAAP,MAAgC,gCAAhC;AAEA;AACA;AACA;AACA;AACA;;AACA,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,KAA9B,EAAqC;AACjC,MAAIA,KAAK,CAACC,IAAN,IAAcD,KAAK,CAACC,IAAN,CAAWF,KAA7B,EAAoC;AAChC,WAAOA,KAAK,CAACG,IAAN,CAAW,UAAAC,IAAI;AAAA,aAAIH,KAAK,CAACC,IAAN,CAAWF,KAAX,CAAiBK,QAAjB,CAA0BD,IAA1B,CAAJ;AAAA,KAAf,CAAP;AACH,GAFD,MAEO;AACH,WAAO,IAAP;AACH;AACJ;AAED;AACA;AACA;AACA;AACA;;;AACA,OAAO,SAASE,iBAAT,CAA2BC,MAA3B,EAAmCP,KAAnC,EAA0C;AAC7C,MAAMQ,GAAG,GAAG,EAAZ;AAEAD,EAAAA,MAAM,CAACE,OAAP,CAAe,UAAAR,KAAK,EAAI;AACpB,QAAMS,GAAG,qBAAQT,KAAR,CAAT;;AACA,QAAIF,aAAa,CAACC,KAAD,EAAQU,GAAR,CAAjB,EAA+B;AAC3B,UAAIA,GAAG,CAACC,QAAR,EAAkB;AACdD,QAAAA,GAAG,CAACC,QAAJ,GAAeL,iBAAiB,CAACI,GAAG,CAACC,QAAL,EAAeX,KAAf,CAAhC;AACH;;AACDQ,MAAAA,GAAG,CAACI,IAAJ,CAASF,GAAT;AACH;AACJ,GARD;AAUA,SAAOF,GAAP;AACH;AAED,IAAMK,KAAK,GAAG;AACVN,EAAAA,MAAM,EAAE,EADE;AAEVO,EAAAA,SAAS,EAAE;AAFD,CAAd;AAKA,IAAMC,SAAS,GAAG;AACdC,EAAAA,UAAU,EAAE,oBAACH,KAAD,EAAQN,MAAR,EAAmB;AAC3BM,IAAAA,KAAK,CAACC,SAAN,GAAkBP,MAAlB;AACAM,IAAAA,KAAK,CAACN,MAAN,GAAeV,cAAc,CAACoB,MAAf,CAAsBV,MAAtB,CAAf;AACH;AAJa,CAAlB;AAOA,IAAMW,OAAO,GAAG;AACZC,EAAAA,cADY,gCACeX,GADf,EACoB;AAAA,QAAfY,MAAe,QAAfA,MAAe;AAC5B,WAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC1B,UAAIC,cAAJ;AACA,UAAIvB,KAAK,GAAGQ,GAAG,CAAC,OAAD,CAAf;;AAEA,UAAIR,KAAK,CAACK,QAAN,CAAe,eAAf,CAAJ,EAAqC;AACjCmB,QAAAA,OAAO,CAACC,GAAR,CAAY,2DAAZ,EAAwE7B,WAAxE;AACA2B,QAAAA,cAAc,GAAG3B,WAAW,IAAI,EAAhC;AACH,OAHD,MAGO;AACH4B,QAAAA,OAAO,CAACC,GAAR,CAAY,6DAAZ,EAA0E7B,WAA1E;AACA2B,QAAAA,cAAc,GAAGjB,iBAAiB,CAACV,WAAD,EAAcI,KAAd,CAAlC;AACH;;AACDoB,MAAAA,MAAM,CAAC,YAAD,EAAeG,cAAf,CAAN;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,uEAAZ,EAAoFF,cAApF;AACAD,MAAAA,OAAO,CAACC,cAAD,CAAP;AACH,KAdM,CAAP;AAeH;AAjBW,CAAhB;AAoBA,eAAe;AACXG,EAAAA,UAAU,EAAE,IADD;AAEXb,EAAAA,KAAK,EAALA,KAFW;AAGXE,EAAAA,SAAS,EAATA,SAHW;AAIXG,EAAAA,OAAO,EAAPA;AAJW,CAAf;AAMAM,OAAO,CAACC,GAAR,CAAY,8CAAZ","sourcesContent":["import { asyncRoutes, constantRoutes } from '@/router'\nimport exportDefaultRouter from \"@/router/export-modules-router\";\n\n/**\n * Use meta.role to determine if the current user has permission\n * @param roles\n * @param route\n */\nfunction hasPermission(roles, route) {\n    if (route.meta && route.meta.roles) {\n        return roles.some(role => route.meta.roles.includes(role))\n    } else {\n        return true\n    }\n}\n\n/**\n * Filter asynchronous routing tables by recursion\n * @param routes asyncRoutes\n * @param roles\n */\nexport function filterAsyncRoutes(routes, roles) {\n    const res = []\n\n    routes.forEach(route => {\n        const tmp = { ...route }\n        if (hasPermission(roles, tmp)) {\n            if (tmp.children) {\n                tmp.children = filterAsyncRoutes(tmp.children, roles)\n            }\n            res.push(tmp)\n        }\n    })\n\n    return res\n}\n\nconst state = {\n    routes: [],\n    addRoutes: []\n}\n\nconst mutations = {\n    SET_ROUTES: (state, routes) => {\n        state.addRoutes = routes\n        state.routes = constantRoutes.concat(routes)\n    }\n}\n\nconst actions = {\n    generateRoutes({ commit }, res) {\n        return new Promise(resolve => {\n            let accessedRoutes\n            let roles = res['roles']\n\n            if (roles.includes('administrator')) {\n                console.log('【./src/store/modules/permission.js】5、当前用户是超级管理员角色，拥有全部权限：',asyncRoutes)\n                accessedRoutes = asyncRoutes || []\n            } else {\n                console.log('【./src/store/modules/permission.js】5、当前用户不是超级管理员角色，需要过滤路由表：',asyncRoutes)\n                accessedRoutes = filterAsyncRoutes(asyncRoutes, roles)\n            }\n            commit('SET_ROUTES', accessedRoutes)\n            console.log('【./src/store/modules/permission.js】6、将过滤后的路由存入 vuex state SET_ROUTES：',accessedRoutes)\n            resolve(accessedRoutes)\n        })\n    }\n}\n\nexport default {\n    namespaced: true,\n    state,\n    mutations,\n    actions\n}\nconsole.log('==>vuex路由[./src/state/modules/permission.js]')\n"]}]}