{"remainingRequest":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js!D:\\wwwroot\\vue-admin-template\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\wwwroot\\vue-admin-template\\src\\store\\modules\\permission.js","mtime":1646650571877},{"path":"D:\\wwwroot\\vue-admin-template\\babel.config.js","mtime":1645316547015},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645316876002},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1645316878558}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovd3d3cm9vdC92dWUtYWRtaW4tdGVtcGxhdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IHsgZmV0Y2hSb2xlTWVudUxpc3QgfSBmcm9tICdAL2FwaS9tZW51JzsKaW1wb3J0IHsgYXN5bmNSb3V0ZXMsIGNvbnN0YW50Um91dGVzLCBtYXAgfSBmcm9tICdAL3JvdXRlcic7IC8vIGltcG9ydCBleHBvcnREZWZhdWx0Um91dGVyIGZyb20gIkAvcm91dGVyL2V4cG9ydC1tb2R1bGVzLXJvdXRlciI7Ly/mnKzlnLDlvIDlj5EKLy8g5bCG5pys5Zywcm91dGVyTWFw5pig5bCE5YiwYWpheOiOt+WPluWIsOeahHNlcnZlclJvdXRlck1hcDsKCmZ1bmN0aW9uIGdlbmVyYXRlQXN5bmNSb3V0ZXIocm91dGVyTWFwLCBzZXJ2ZXJSb3V0ZXJNYXApIHsKICBzZXJ2ZXJSb3V0ZXJNYXAuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgIGl0ZW0uY29tcG9uZW50ID0gcm91dGVyTWFwW2l0ZW0uY29tcG9uZW50XTsKCiAgICBpZiAoaXRlbS5jaGlsZHJlbiAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgZ2VuZXJhdGVBc3luY1JvdXRlcihyb3V0ZXJNYXAsIGl0ZW0uY2hpbGRyZW4pOwogICAgfQogIH0pOwogIHJldHVybiBzZXJ2ZXJSb3V0ZXJNYXA7Cn0KLyoqCiAqIFVzZSBtZXRhLnJvbGUgdG8gZGV0ZXJtaW5lIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIHBlcm1pc3Npb24KICogQHBhcmFtIHJvbGVzCiAqIEBwYXJhbSByb3V0ZQogKi8KCgpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHJvbGVzLCByb3V0ZSkgewogIGlmIChyb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEucm9sZXMpIHsKICAgIHJldHVybiByb2xlcy5zb21lKGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgIHJldHVybiByb3V0ZS5tZXRhLnJvbGVzLmluY2x1ZGVzKHJvbGUpOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQovKioKICogRmlsdGVyIGFzeW5jaHJvbm91cyByb3V0aW5nIHRhYmxlcyBieSByZWN1cnNpb24KICogQHBhcmFtIHJvdXRlcyBhc3luY1JvdXRlcwogKiBAcGFyYW0gcm9sZXMKICovCgoKZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVzKHJvdXRlcywgcm9sZXMpIHsKICB2YXIgcmVzID0gW107CiAgcm91dGVzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlKSB7CiAgICB2YXIgdG1wID0gX29iamVjdFNwcmVhZCh7fSwgcm91dGUpOwoKICAgIGlmIChoYXNQZXJtaXNzaW9uKHJvbGVzLCB0bXApKSB7CiAgICAgIGlmICh0bXAuY2hpbGRyZW4pIHsKICAgICAgICB0bXAuY2hpbGRyZW4gPSBmaWx0ZXJBc3luY1JvdXRlcyh0bXAuY2hpbGRyZW4sIHJvbGVzKTsKICAgICAgfQoKICAgICAgcmVzLnB1c2godG1wKTsKICAgIH0KICB9KTsKICByZXR1cm4gcmVzOwp9CnZhciBzdGF0ZSA9IHsKICByb3V0ZXM6IFtdLAogIGFkZFJvdXRlczogW10KfTsKdmFyIG11dGF0aW9ucyA9IHsKICBTRVRfUk9VVEVTOiBmdW5jdGlvbiBTRVRfUk9VVEVTKHN0YXRlLCByb3V0ZXMpIHsKICAgIHN0YXRlLmFkZFJvdXRlcyA9IHJvdXRlczsKICAgIHN0YXRlLnJvdXRlcyA9IGNvbnN0YW50Um91dGVzLmNvbmNhdChyb3V0ZXMpOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgZ2VuZXJhdGVSb3V0ZXM6IGZ1bmN0aW9uIGdlbmVyYXRlUm91dGVzKF9yZWYsIHJlcykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHZhciBhY2Nlc3NlZFJvdXRlczsKICAgICAgdmFyIHJvbGVzID0gcmVzWydyb2xlcyddOwogICAgICBmZXRjaFJvbGVNZW51TGlzdCh7CiAgICAgICAgcm9sZXM6IHJvbGVzCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgY29uc29sZS5sb2coJ+OAkC4vc3JjL3N0b3JlL21vZHVsZXMvcGVybWlzc2lvbi5qc+OAkTTjgIHmoLnmja7op5LoibLku47lkI7nq6/mi4nlj5blr7nlupToj5zljZXvvJonLCByZXNwb25zZS5kYXRhKTsKICAgICAgICB2YXIgc2VydmVyUm91dGVycyA9IGdlbmVyYXRlQXN5bmNSb3V0ZXIobWFwLCByZXNwb25zZS5kYXRhKTsKICAgICAgICB2YXIgcm91dGVycyA9IHNlcnZlclJvdXRlcnMuY29uY2F0KGFzeW5jUm91dGVzKTsKCiAgICAgICAgaWYgKHJvbGVzLmluY2x1ZGVzKCdhZG1pbmlzdHJhdG9yJykpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfjgJAuL3NyYy9zdG9yZS9tb2R1bGVzL3Blcm1pc3Npb24uanPjgJE144CB5b2T5YmN55So5oi35piv6LaF57qn566h55CG5ZGY6KeS6Imy77yM5oul5pyJ5YWo6YOo5p2D6ZmQ77yaJywgcm91dGVycyk7CiAgICAgICAgICBhY2Nlc3NlZFJvdXRlcyA9IHJvdXRlcnMgfHwgW107CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfjgJAuL3NyYy9zdG9yZS9tb2R1bGVzL3Blcm1pc3Npb24uanPjgJE144CB5b2T5YmN55So5oi35LiN5piv6LaF57qn566h55CG5ZGY6KeS6Imy77yM6ZyA6KaB6L+H5ruk6Lev55Sx6KGo77yaJywgcm91dGVycyk7CiAgICAgICAgICBhY2Nlc3NlZFJvdXRlcyA9IGZpbHRlckFzeW5jUm91dGVzKHJvdXRlcnMsIHJvbGVzKTsKICAgICAgICB9CgogICAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKTsKICAgICAgICBjb25zb2xlLmxvZygn44CQLi9zcmMvc3RvcmUvbW9kdWxlcy9wZXJtaXNzaW9uLmpz44CRNuOAgeWwhui/h+a7pOWQjueahOi3r+eUseWtmOWFpSB2dWV4IHN0YXRlIFNFVF9ST1VURVPvvJonLCBhY2Nlc3NlZFJvdXRlcyk7CiAgICAgICAgcmVzb2x2ZShhY2Nlc3NlZFJvdXRlcyk7CiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKCfmi4nlj5bop5LoibLoj5zljZXlpLHotKUnLCBlcnJvci5tZXNzYWdlKCkpOwogICAgICB9KTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTsKY29uc29sZS5sb2coJz09PnZ1ZXjot6/nlLFbLi9zcmMvc3RhdGUvbW9kdWxlcy9wZXJtaXNzaW9uLmpzXScpOw=="},{"version":3,"sources":["D:/wwwroot/vue-admin-template/src/store/modules/permission.js"],"names":["fetchRoleMenuList","asyncRoutes","constantRoutes","map","generateAsyncRouter","routerMap","serverRouterMap","forEach","item","index","component","children","length","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","tmp","push","state","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","commit","Promise","resolve","accessedRoutes","then","response","console","log","data","serverRouters","routers","error","message","namespaced"],"mappings":"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","sourcesContent":["import { fetchRoleMenuList } from '@/api/menu'\nimport { asyncRoutes, constantRoutes,map } from '@/router'\n// import exportDefaultRouter from \"@/router/export-modules-router\";//本地开发\n\n// 将本地routerMap映射到ajax获取到的serverRouterMap;\nfunction generateAsyncRouter(routerMap, serverRouterMap) {\n    serverRouterMap.forEach(function (item, index) {\n        item.component = routerMap[item.component]\n        if(item.children && item.children.length > 0){\n            generateAsyncRouter(routerMap, item.children)\n        }\n    })\n    return serverRouterMap;\n}\n\n/**\n * Use meta.role to determine if the current user has permission\n * @param roles\n * @param route\n */\nfunction hasPermission(roles, route) {\n    if (route.meta && route.meta.roles) {\n        return roles.some(role => route.meta.roles.includes(role))\n    } else {\n        return true\n    }\n}\n\n/**\n * Filter asynchronous routing tables by recursion\n * @param routes asyncRoutes\n * @param roles\n */\nexport function filterAsyncRoutes(routes, roles) {\n    const res = []\n\n    routes.forEach(route => {\n        const tmp = { ...route }\n        if (hasPermission(roles, tmp)) {\n            if (tmp.children) {\n                tmp.children = filterAsyncRoutes(tmp.children, roles)\n            }\n            res.push(tmp)\n        }\n    })\n\n    return res\n}\n\nconst state = {\n    routes: [],\n    addRoutes: []\n}\n\nconst mutations = {\n    SET_ROUTES: (state, routes) => {\n        state.addRoutes = routes\n        state.routes = constantRoutes.concat(routes)\n    }\n}\n\nconst actions = {\n    generateRoutes({ commit }, res) {\n        return new Promise(resolve => {\n            let accessedRoutes\n            let roles = res['roles']\n            fetchRoleMenuList({roles:roles}).then(response => {\n                console.log('【./src/store/modules/permission.js】4、根据角色从后端拉取对应菜单：',response.data)\n                let serverRouters = generateAsyncRouter(map, response.data)\n                let routers = serverRouters.concat(asyncRoutes)\n                if (roles.includes('administrator')) {\n                    console.log('【./src/store/modules/permission.js】5、当前用户是超级管理员角色，拥有全部权限：',routers)\n                    accessedRoutes = routers || []\n                } else {\n                    console.log('【./src/store/modules/permission.js】5、当前用户不是超级管理员角色，需要过滤路由表：',routers)\n                    accessedRoutes = filterAsyncRoutes(routers, roles)\n                }\n                commit('SET_ROUTES', accessedRoutes)\n                console.log('【./src/store/modules/permission.js】6、将过滤后的路由存入 vuex state SET_ROUTES：',accessedRoutes)\n                resolve(accessedRoutes)\n            },error => {\n                console.log('拉取角色菜单失败',error.message())\n            })\n        })\n    }\n}\n\nexport default {\n    namespaced: true,\n    state,\n    mutations,\n    actions\n}\nconsole.log('==>vuex路由[./src/state/modules/permission.js]')\n"]}]}