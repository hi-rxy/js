{"remainingRequest":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js!D:\\wwwroot\\vue-admin-template\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\wwwroot\\vue-admin-template\\src\\store\\modules\\permission.js","mtime":1646578038744},{"path":"D:\\wwwroot\\vue-admin-template\\babel.config.js","mtime":1645316547015},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645316876002},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1645316878558}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovd3d3cm9vdC92dWUtYWRtaW4tdGVtcGxhdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCB7IGZldGNoUm9sZU1lbnVMaXN0IH0gZnJvbSAnQC9hcGkvbWVudSc7CmltcG9ydCB7IGFzeW5jUm91dGVzLCBjb25zdGFudFJvdXRlcywgbWFwIH0gZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgZXhwb3J0RGVmYXVsdFJvdXRlciBmcm9tICJAL3JvdXRlci9leHBvcnQtbW9kdWxlcy1yb3V0ZXIiOyAvLyDlsIbmnKzlnLByb3V0ZXJNYXDmmKDlsITliLBhamF46I635Y+W5Yiw55qEc2VydmVyUm91dGVyTWFwOwoKZnVuY3Rpb24gZ2VuZXJhdGVBc3luY1JvdXRlcihyb3V0ZXJNYXAsIHNlcnZlclJvdXRlck1hcCkgewogIHNlcnZlclJvdXRlck1hcCA9IEFycmF5LmZyb20oc2VydmVyUm91dGVyTWFwKTsKICBzZXJ2ZXJSb3V0ZXJNYXAuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgIGl0ZW0uY29tcG9uZW50ID0gcm91dGVyTWFwW2l0ZW0uY29tcG9uZW50XTsKCiAgICBpZiAoaXRlbS5jaGlsZHJlbiAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgZ2VuZXJhdGVBc3luY1JvdXRlcihyb3V0ZXJNYXAsIGl0ZW0uY2hpbGRyZW4pOwogICAgfQogIH0pOwogIHJldHVybiBzZXJ2ZXJSb3V0ZXJNYXA7Cn0KLyoqCiAqIFVzZSBtZXRhLnJvbGUgdG8gZGV0ZXJtaW5lIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIHBlcm1pc3Npb24KICogQHBhcmFtIHJvbGVzCiAqIEBwYXJhbSByb3V0ZQogKi8KCgpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHJvbGVzLCByb3V0ZSkgewogIGlmIChyb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEucm9sZXMpIHsKICAgIHJldHVybiByb2xlcy5zb21lKGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgIHJldHVybiByb3V0ZS5tZXRhLnJvbGVzLmluY2x1ZGVzKHJvbGUpOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQovKioKICogRmlsdGVyIGFzeW5jaHJvbm91cyByb3V0aW5nIHRhYmxlcyBieSByZWN1cnNpb24KICogQHBhcmFtIHJvdXRlcyBhc3luY1JvdXRlcwogKiBAcGFyYW0gcm9sZXMKICovCgoKZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVzKHJvdXRlcywgcm9sZXMpIHsKICB2YXIgcmVzID0gW107CiAgcm91dGVzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlKSB7CiAgICB2YXIgdG1wID0gX29iamVjdFNwcmVhZCh7fSwgcm91dGUpOwoKICAgIGlmIChoYXNQZXJtaXNzaW9uKHJvbGVzLCB0bXApKSB7CiAgICAgIGlmICh0bXAuY2hpbGRyZW4pIHsKICAgICAgICB0bXAuY2hpbGRyZW4gPSBmaWx0ZXJBc3luY1JvdXRlcyh0bXAuY2hpbGRyZW4sIHJvbGVzKTsKICAgICAgfQoKICAgICAgcmVzLnB1c2godG1wKTsKICAgIH0KICB9KTsKICByZXR1cm4gcmVzOwp9CnZhciBzdGF0ZSA9IHsKICByb3V0ZXM6IFtdLAogIGFkZFJvdXRlczogW10KfTsKdmFyIG11dGF0aW9ucyA9IHsKICBTRVRfUk9VVEVTOiBmdW5jdGlvbiBTRVRfUk9VVEVTKHN0YXRlLCByb3V0ZXMpIHsKICAgIHN0YXRlLmFkZFJvdXRlcyA9IHJvdXRlczsKICAgIHN0YXRlLnJvdXRlcyA9IGNvbnN0YW50Um91dGVzLmNvbmNhdChyb3V0ZXMpOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgZ2VuZXJhdGVSb3V0ZXM6IGZ1bmN0aW9uIGdlbmVyYXRlUm91dGVzKF9yZWYsIHJlcykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHZhciBhY2Nlc3NlZFJvdXRlczsKICAgICAgdmFyIHJvbGVzID0gcmVzWydyb2xlcyddOwogICAgICBmZXRjaFJvbGVNZW51TGlzdCh7CiAgICAgICAgcm9sZXM6IHJvbGVzCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgLy8gbGV0IGFzeW5jUm91dGVzID0gcmVzcG9uc2UuZGF0YQogICAgICAgIC8vIGNvbnNvbGUubG9nKCfjgJAuL3NyYy9zdG9yZS9tb2R1bGVzL3Blcm1pc3Npb24uanPjgJE144CB5qC55o2u6KeS6Imy5LuO5ZCO56uv5ouJ5Y+W5a+55bqU6I+c5Y2V77yaJyxhc3luY1JvdXRlcykKICAgICAgICAvLyBsZXQgYXN5bmNSb3V0ZXJNYXAgPSBnZW5lcmF0ZUFzeW5jUm91dGVyKG1hcCwgYXN5bmNSb3V0ZXMpCiAgICAgICAgLy8gY29uc29sZS5sb2coYXN5bmNSb3V0ZXJNYXApCiAgICAgICAgdmFyIHJvdXRlcnMgPSBleHBvcnREZWZhdWx0Um91dGVyLmNvbmNhdChhc3luY1JvdXRlcyk7CgogICAgICAgIGlmIChyb2xlcy5pbmNsdWRlcygnYWRtaW5pc3RyYXRvcicpKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn44CQLi9zcmMvc3RvcmUvbW9kdWxlcy9wZXJtaXNzaW9uLmpz44CRNeOAgeW9k+WJjeeUqOaIt+aYr+i2hee6p+euoeeQhuWRmOinkuiJsu+8jOaLpeacieWFqOmDqOadg+mZkO+8micsIHJvdXRlcnMpOwogICAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSByb3V0ZXJzIHx8IFtdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn44CQLi9zcmMvc3RvcmUvbW9kdWxlcy9wZXJtaXNzaW9uLmpz44CRNeOAgeW9k+WJjeeUqOaIt+S4jeaYr+i2hee6p+euoeeQhuWRmOinkuiJsu+8jOmcgOimgei/h+a7pOi3r+eUseihqO+8micsIHJvdXRlcnMpOwogICAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSBmaWx0ZXJBc3luY1JvdXRlcyhyb3V0ZXJzLCByb2xlcyk7CiAgICAgICAgfQoKICAgICAgICBjb21taXQoJ1NFVF9ST1VURVMnLCBhY2Nlc3NlZFJvdXRlcyk7CiAgICAgICAgY29uc29sZS5sb2coJ+OAkC4vc3JjL3N0b3JlL21vZHVsZXMvcGVybWlzc2lvbi5qc+OAkTbjgIHlsIbov4fmu6TlkI7nmoTot6/nlLHlrZjlhaUgdnVleCBzdGF0ZSBTRVRfUk9VVEVT77yaJywgYWNjZXNzZWRSb3V0ZXMpOwogICAgICAgIHJlc29sdmUoYWNjZXNzZWRSb3V0ZXMpOwogICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZygn5ouJ5Y+W6KeS6Imy6I+c5Y2V5aSx6LSlJywgZXJyb3IubWVzc2FnZSgpKTsKICAgICAgfSk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBzdGF0ZSwKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zCn07CmNvbnNvbGUubG9nKCc9PT52dWV46Lev55SxWy4vc3JjL3N0YXRlL21vZHVsZXMvcGVybWlzc2lvbi5qc10nKTs="},{"version":3,"sources":["D:/wwwroot/vue-admin-template/src/store/modules/permission.js"],"names":["fetchRoleMenuList","asyncRoutes","constantRoutes","map","exportDefaultRouter","generateAsyncRouter","routerMap","serverRouterMap","Array","from","forEach","item","index","component","children","length","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","tmp","push","state","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","commit","Promise","resolve","accessedRoutes","then","response","routers","console","log","error","message","namespaced"],"mappings":"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","sourcesContent":["import { fetchRoleMenuList } from '@/api/menu'\nimport { asyncRoutes, constantRoutes,map } from '@/router'\nimport exportDefaultRouter from \"@/router/export-modules-router\";\n\n// 将本地routerMap映射到ajax获取到的serverRouterMap;\nfunction generateAsyncRouter(routerMap, serverRouterMap) {\n    serverRouterMap = Array.from(serverRouterMap);\n    serverRouterMap.forEach(function (item, index) {\n        item.component = routerMap[item.component]\n        if(item.children && item.children.length > 0){\n            generateAsyncRouter(routerMap, item.children)\n        }\n    })\n    return serverRouterMap;\n}\n\n/**\n * Use meta.role to determine if the current user has permission\n * @param roles\n * @param route\n */\nfunction hasPermission(roles, route) {\n    if (route.meta && route.meta.roles) {\n        return roles.some(role => route.meta.roles.includes(role))\n    } else {\n        return true\n    }\n}\n\n/**\n * Filter asynchronous routing tables by recursion\n * @param routes asyncRoutes\n * @param roles\n */\nexport function filterAsyncRoutes(routes, roles) {\n    const res = []\n\n    routes.forEach(route => {\n        const tmp = { ...route }\n        if (hasPermission(roles, tmp)) {\n            if (tmp.children) {\n                tmp.children = filterAsyncRoutes(tmp.children, roles)\n            }\n            res.push(tmp)\n        }\n    })\n\n    return res\n}\n\nconst state = {\n    routes: [],\n    addRoutes: []\n}\n\nconst mutations = {\n    SET_ROUTES: (state, routes) => {\n        state.addRoutes = routes\n        state.routes = constantRoutes.concat(routes)\n    }\n}\n\nconst actions = {\n    generateRoutes({ commit }, res) {\n        return new Promise(resolve => {\n            let accessedRoutes\n            let roles = res['roles']\n\n            fetchRoleMenuList({roles:roles}).then(response => {\n                // let asyncRoutes = response.data\n                // console.log('【./src/store/modules/permission.js】5、根据角色从后端拉取对应菜单：',asyncRoutes)\n                // let asyncRouterMap = generateAsyncRouter(map, asyncRoutes)\n                // console.log(asyncRouterMap)\n                let routers = exportDefaultRouter.concat(asyncRoutes)\n                if (roles.includes('administrator')) {\n                    console.log('【./src/store/modules/permission.js】5、当前用户是超级管理员角色，拥有全部权限：',routers)\n                    accessedRoutes = routers || []\n                } else {\n                    console.log('【./src/store/modules/permission.js】5、当前用户不是超级管理员角色，需要过滤路由表：',routers)\n                    accessedRoutes = filterAsyncRoutes(routers, roles)\n                }\n                commit('SET_ROUTES', accessedRoutes)\n                console.log('【./src/store/modules/permission.js】6、将过滤后的路由存入 vuex state SET_ROUTES：',accessedRoutes)\n                resolve(accessedRoutes)\n            },error => {\n                console.log('拉取角色菜单失败',error.message())\n            })\n        })\n    }\n}\n\nexport default {\n    namespaced: true,\n    state,\n    mutations,\n    actions\n}\nconsole.log('==>vuex路由[./src/state/modules/permission.js]')\n"]}]}