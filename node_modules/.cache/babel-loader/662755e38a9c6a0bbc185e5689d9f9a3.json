{"remainingRequest":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js!D:\\wwwroot\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\wwwroot\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\wwwroot\\vue-admin-template\\src\\components\\HeaderSearch\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\wwwroot\\vue-admin-template\\src\\components\\HeaderSearch\\index.vue","mtime":1645270047713},{"path":"D:\\wwwroot\\vue-admin-template\\babel.config.js","mtime":1645316547015},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645316876002},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1645316878558},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645316876002},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":1645316879025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJEOi93d3dyb290L3Z1ZS1hZG1pbi10ZW1wbGF0ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIgZnJvbSAiRDovd3d3cm9vdC92dWUtYWRtaW4tdGVtcGxhdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLyBmdXNlIGlzIGEgbGlnaHR3ZWlnaHQgZnV6enktc2VhcmNoIG1vZHVsZQovLyBtYWtlIHNlYXJjaCByZXN1bHRzIG1vcmUgaW4gbGluZSB3aXRoIGV4cGVjdGF0aW9ucwppbXBvcnQgRnVzZSBmcm9tICdmdXNlLmpzJzsKaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnSGVhZGVyU2VhcmNoJywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNoOiAnJywKICAgICAgb3B0aW9uczogW10sCiAgICAgIHNlYXJjaFBvb2w6IFtdLAogICAgICBzaG93OiBmYWxzZSwKICAgICAgZnVzZTogdW5kZWZpbmVkCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHJvdXRlczogZnVuY3Rpb24gcm91dGVzKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy5wZXJtaXNzaW9uX3JvdXRlczsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICByb3V0ZXM6IGZ1bmN0aW9uIHJvdXRlcygpIHsKICAgICAgdGhpcy5zZWFyY2hQb29sID0gdGhpcy5nZW5lcmF0ZVJvdXRlcyh0aGlzLnJvdXRlcyk7CiAgICB9LAogICAgc2VhcmNoUG9vbDogZnVuY3Rpb24gc2VhcmNoUG9vbChsaXN0KSB7CiAgICAgIHRoaXMuaW5pdEZ1c2UobGlzdCk7CiAgICB9LAogICAgc2hvdzogZnVuY3Rpb24gc2hvdyh2YWx1ZSkgewogICAgICBpZiAodmFsdWUpIHsKICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2UpOwogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5zZWFyY2hQb29sID0gdGhpcy5nZW5lcmF0ZVJvdXRlcyh0aGlzLnJvdXRlcyk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBjbGljazogZnVuY3Rpb24gY2xpY2soKSB7CiAgICAgIHRoaXMuc2hvdyA9ICF0aGlzLnNob3c7CgogICAgICBpZiAodGhpcy5zaG93KSB7CiAgICAgICAgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QgJiYgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QuZm9jdXMoKTsKICAgICAgfQogICAgfSwKICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHsKICAgICAgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QgJiYgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QuYmx1cigpOwogICAgICB0aGlzLm9wdGlvbnMgPSBbXTsKICAgICAgdGhpcy5zaG93ID0gZmFsc2U7CiAgICB9LAogICAgY2hhbmdlOiBmdW5jdGlvbiBjaGFuZ2UodmFsKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh2YWwucGF0aCk7CiAgICAgIHRoaXMuc2VhcmNoID0gJyc7CiAgICAgIHRoaXMub3B0aW9ucyA9IFtdOwogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuc2hvdyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICBpbml0RnVzZTogZnVuY3Rpb24gaW5pdEZ1c2UobGlzdCkgewogICAgICB0aGlzLmZ1c2UgPSBuZXcgRnVzZShsaXN0LCB7CiAgICAgICAgc2hvdWxkU29ydDogdHJ1ZSwKICAgICAgICB0aHJlc2hvbGQ6IDAuNCwKICAgICAgICBsb2NhdGlvbjogMCwKICAgICAgICBkaXN0YW5jZTogMTAwLAogICAgICAgIG1heFBhdHRlcm5MZW5ndGg6IDMyLAogICAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aDogMSwKICAgICAgICBrZXlzOiBbewogICAgICAgICAgbmFtZTogJ3RpdGxlJywKICAgICAgICAgIHdlaWdodDogMC43CiAgICAgICAgfSwgewogICAgICAgICAgbmFtZTogJ3BhdGgnLAogICAgICAgICAgd2VpZ2h0OiAwLjMKICAgICAgICB9XQogICAgICB9KTsKICAgIH0sCiAgICAvLyBGaWx0ZXIgb3V0IHRoZSByb3V0ZXMgdGhhdCBjYW4gYmUgZGlzcGxheWVkIGluIHRoZSBzaWRlYmFyCiAgICAvLyBBbmQgZ2VuZXJhdGUgdGhlIGludGVybmF0aW9uYWxpemVkIHRpdGxlCiAgICBnZW5lcmF0ZVJvdXRlczogZnVuY3Rpb24gZ2VuZXJhdGVSb3V0ZXMocm91dGVzKSB7CiAgICAgIHZhciBiYXNlUGF0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJy8nOwogICAgICB2YXIgcHJlZml4VGl0bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IFtdOwogICAgICB2YXIgcmVzID0gW107CgogICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocm91dGVzKSwKICAgICAgICAgIF9zdGVwOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgdmFyIHJvdXRlciA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgIC8vIHNraXAgaGlkZGVuIHJvdXRlcgogICAgICAgICAgaWYgKHJvdXRlci5oaWRkZW4pIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgICAgIHBhdGg6IHBhdGgucmVzb2x2ZShiYXNlUGF0aCwgcm91dGVyLnBhdGgpLAogICAgICAgICAgICB0aXRsZTogX3RvQ29uc3VtYWJsZUFycmF5KHByZWZpeFRpdGxlKQogICAgICAgICAgfTsKCiAgICAgICAgICBpZiAocm91dGVyLm1ldGEgJiYgcm91dGVyLm1ldGEudGl0bGUpIHsKICAgICAgICAgICAgZGF0YS50aXRsZSA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZGF0YS50aXRsZSksIFtyb3V0ZXIubWV0YS50aXRsZV0pOwoKICAgICAgICAgICAgaWYgKHJvdXRlci5yZWRpcmVjdCAhPT0gJ25vUmVkaXJlY3QnKSB7CiAgICAgICAgICAgICAgLy8gb25seSBwdXNoIHRoZSByb3V0ZXMgd2l0aCB0aXRsZQogICAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogbmVlZCB0byBleGNsdWRlIHBhcmVudCByb3V0ZXIgd2l0aG91dCByZWRpcmVjdAogICAgICAgICAgICAgIHJlcy5wdXNoKGRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIHJlY3Vyc2l2ZSBjaGlsZCByb3V0ZXMKCgogICAgICAgICAgaWYgKHJvdXRlci5jaGlsZHJlbikgewogICAgICAgICAgICB2YXIgdGVtcFJvdXRlcyA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXMocm91dGVyLmNoaWxkcmVuLCBkYXRhLnBhdGgsIGRhdGEudGl0bGUpOwoKICAgICAgICAgICAgaWYgKHRlbXBSb3V0ZXMubGVuZ3RoID49IDEpIHsKICAgICAgICAgICAgICByZXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHJlcyksIF90b0NvbnN1bWFibGVBcnJheSh0ZW1wUm91dGVzKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlczsKICAgIH0sCiAgICBxdWVyeVNlYXJjaDogZnVuY3Rpb24gcXVlcnlTZWFyY2gocXVlcnkpIHsKICAgICAgaWYgKHF1ZXJ5ICE9PSAnJykgewogICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuZnVzZS5zZWFyY2gocXVlcnkpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMub3B0aW9ucyA9IFtdOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AAEA;AACAA,sBADA;AAEAC,MAFA,kBAEA;AACA;AACAC,gBADA;AAEAC,iBAFA;AAGAC,oBAHA;AAIAC,iBAJA;AAKAC;AALA;AAOA,GAVA;AAWAC;AACAC,UADA,oBACA;AACA;AACA;AAHA,GAXA;AAgBAC;AACAD,UADA,oBACA;AACA;AACA,KAHA;AAIAJ,cAJA,sBAIAM,IAJA,EAIA;AACA;AACA,KANA;AAOAL,QAPA,gBAOAM,KAPA,EAOA;AACA;AACAC;AACA,OAFA,MAEA;AACAA;AACA;AACA;AAbA,GAhBA;AA+BAC,SA/BA,qBA+BA;AACA;AACA,GAjCA;AAkCAC;AACAC,SADA,mBACA;AACA;;AACA;AACA;AACA;AACA,KANA;AAOAC,SAPA,mBAOA;AACA;AACA;AACA;AACA,KAXA;AAYAC,UAZA,kBAYAC,GAZA,EAYA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA,OAFA;AAGA,KAnBA;AAoBAC,YApBA,oBAoBAT,IApBA,EAoBA;AACA;AACAU,wBADA;AAEAC,sBAFA;AAGAC,mBAHA;AAIAC,qBAJA;AAKAC,4BALA;AAMAC,6BANA;AAOAC;AACA1B,uBADA;AAEA2B;AAFA,WAGA;AACA3B,sBADA;AAEA2B;AAFA,SAHA;AAPA;AAeA,KApCA;AAqCA;AACA;AACAC,kBAvCA,0BAuCApB,MAvCA,EAuCA;AAAA;AAAA;AACA;;AADA,iDAGAA,MAHA;AAAA;;AAAA;AAGA;AAAA;;AACA;AACA;AAAA;AAAA;;AAEA;AACAqB,qDADA;AAEAC;AAFA;;AAKA;AACA7B;;AAEA;AACA;AACA;AACA8B;AACA;AACA,WAjBA,CAmBA;;;AACA;AACA;;AACA;AACAA;AACA;AACA;AACA;AA7BA;AAAA;AAAA;AAAA;AAAA;;AA8BA;AACA,KAtEA;AAuEAC,eAvEA,uBAuEAC,KAvEA,EAuEA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AA7EA;AAlCA","names":["name","data","search","options","searchPool","show","fuse","computed","routes","watch","list","value","document","mounted","methods","click","close","change","val","initFuse","shouldSort","threshold","location","distance","maxPatternLength","minMatchCharLength","keys","weight","generateRoutes","path","title","res","querySearch","query"],"sourceRoot":"src/components/HeaderSearch","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div :class=\"{'show':show}\" class=\"header-search\">\r\n    <svg-icon class-name=\"search-icon\" icon-class=\"search\" @click.stop=\"click\" />\r\n    <el-select\r\n      ref=\"headerSearchSelect\"\r\n      v-model=\"search\"\r\n      :remote-method=\"querySearch\"\r\n      filterable\r\n      default-first-option\r\n      remote\r\n      placeholder=\"Search\"\r\n      class=\"header-search-select\"\r\n      @change=\"change\"\r\n    >\r\n      <el-option v-for=\"item in options\" :key=\"item.path\" :value=\"item\" :label=\"item.title.join(' > ')\" />\r\n    </el-select>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// fuse is a lightweight fuzzy-search module\r\n// make search results more in line with expectations\r\nimport Fuse from 'fuse.js'\r\nimport path from 'path'\r\n\r\nexport default {\r\n  name: 'HeaderSearch',\r\n  data() {\r\n    return {\r\n      search: '',\r\n      options: [],\r\n      searchPool: [],\r\n      show: false,\r\n      fuse: undefined\r\n    }\r\n  },\r\n  computed: {\r\n    routes() {\r\n      return this.$store.getters.permission_routes\r\n    }\r\n  },\r\n  watch: {\r\n    routes() {\r\n      this.searchPool = this.generateRoutes(this.routes)\r\n    },\r\n    searchPool(list) {\r\n      this.initFuse(list)\r\n    },\r\n    show(value) {\r\n      if (value) {\r\n        document.body.addEventListener('click', this.close)\r\n      } else {\r\n        document.body.removeEventListener('click', this.close)\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.searchPool = this.generateRoutes(this.routes)\r\n  },\r\n  methods: {\r\n    click() {\r\n      this.show = !this.show\r\n      if (this.show) {\r\n        this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.focus()\r\n      }\r\n    },\r\n    close() {\r\n      this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.blur()\r\n      this.options = []\r\n      this.show = false\r\n    },\r\n    change(val) {\r\n      this.$router.push(val.path)\r\n      this.search = ''\r\n      this.options = []\r\n      this.$nextTick(() => {\r\n        this.show = false\r\n      })\r\n    },\r\n    initFuse(list) {\r\n      this.fuse = new Fuse(list, {\r\n        shouldSort: true,\r\n        threshold: 0.4,\r\n        location: 0,\r\n        distance: 100,\r\n        maxPatternLength: 32,\r\n        minMatchCharLength: 1,\r\n        keys: [{\r\n          name: 'title',\r\n          weight: 0.7\r\n        }, {\r\n          name: 'path',\r\n          weight: 0.3\r\n        }]\r\n      })\r\n    },\r\n    // Filter out the routes that can be displayed in the sidebar\r\n    // And generate the internationalized title\r\n    generateRoutes(routes, basePath = '/', prefixTitle = []) {\r\n      let res = []\r\n\r\n      for (const router of routes) {\r\n        // skip hidden router\r\n        if (router.hidden) { continue }\r\n\r\n        const data = {\r\n          path: path.resolve(basePath, router.path),\r\n          title: [...prefixTitle]\r\n        }\r\n\r\n        if (router.meta && router.meta.title) {\r\n          data.title = [...data.title, router.meta.title]\r\n\r\n          if (router.redirect !== 'noRedirect') {\r\n            // only push the routes with title\r\n            // special case: need to exclude parent router without redirect\r\n            res.push(data)\r\n          }\r\n        }\r\n\r\n        // recursive child routes\r\n        if (router.children) {\r\n          const tempRoutes = this.generateRoutes(router.children, data.path, data.title)\r\n          if (tempRoutes.length >= 1) {\r\n            res = [...res, ...tempRoutes]\r\n          }\r\n        }\r\n      }\r\n      return res\r\n    },\r\n    querySearch(query) {\r\n      if (query !== '') {\r\n        this.options = this.fuse.search(query)\r\n      } else {\r\n        this.options = []\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.header-search {\r\n  font-size: 0 !important;\r\n\r\n  .search-icon {\r\n    cursor: pointer;\r\n    font-size: 18px;\r\n    vertical-align: middle;\r\n  }\r\n\r\n  .header-search-select {\r\n    font-size: 18px;\r\n    transition: width 0.2s;\r\n    width: 0;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    border-radius: 0;\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n\r\n    ::v-deep .el-input__inner {\r\n      border-radius: 0;\r\n      border: 0;\r\n      padding-left: 0;\r\n      padding-right: 0;\r\n      box-shadow: none !important;\r\n      border-bottom: 1px solid #d9d9d9;\r\n      vertical-align: middle;\r\n    }\r\n  }\r\n\r\n  &.show {\r\n    .header-search-select {\r\n      width: 210px;\r\n      margin-left: 10px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}