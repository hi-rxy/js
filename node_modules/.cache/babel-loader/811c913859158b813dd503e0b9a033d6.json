{"remainingRequest":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js!D:\\wwwroot\\vue-admin-template\\src\\permission.js","dependencies":[{"path":"D:\\wwwroot\\vue-admin-template\\src\\permission.js","mtime":1645971631888},{"path":"D:\\wwwroot\\vue-admin-template\\babel.config.js","mtime":1645316547015},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645316876002},{"path":"D:\\wwwroot\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1645316878558}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovd3d3cm9vdC92dWUtYWRtaW4tdGVtcGxhdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgX3R5cGVvZiBmcm9tICJEOi93d3dyb290L3Z1ZS1hZG1pbi10ZW1wbGF0ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L3d3d3Jvb3QvdnVlLWFkbWluLXRlbXBsYXRlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0IHJvdXRlciBmcm9tICcuL3JvdXRlcic7CmltcG9ydCBzdG9yZSBmcm9tICcuL3N0b3JlJzsKaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtdWknOwppbXBvcnQgTlByb2dyZXNzIGZyb20gJ25wcm9ncmVzcyc7IC8vIHByb2dyZXNzIGJhcgoKaW1wb3J0ICducHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyc7IC8vIHByb2dyZXNzIGJhciBzdHlsZQoKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOyAvLyBnZXQgdG9rZW4gZnJvbSBjb29raWUKCmltcG9ydCBnZXRQYWdlVGl0bGUgZnJvbSAnQC91dGlscy9nZXQtcGFnZS10aXRsZSc7Ck5Qcm9ncmVzcy5jb25maWd1cmUoewogIHNob3dTcGlubmVyOiBmYWxzZQp9KTsgLy8gTlByb2dyZXNzIENvbmZpZ3VyYXRpb24KCnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbiddOyAvLyBubyByZWRpcmVjdCB3aGl0ZWxpc3QKCnJvdXRlci5iZWZvcmVFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICB2YXIgaGFzVG9rZW4sIGhhc0dldFVzZXJJbmZvLCByZXN1bHQsIHJvbGVzOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb25zb2xlLmxvZygnPT0+6Lev55Sx6ZKp5a2Q5byA5aeLWy4vc3JjL3Blcm1pc3Npb24uanNdJyk7IC8vIHN0YXJ0IHByb2dyZXNzIGJhcgoKICAgICAgICAgICAgTlByb2dyZXNzLnN0YXJ0KCk7IC8vIHNldCBwYWdlIHRpdGxlCgogICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGdldFBhZ2VUaXRsZSh0by5tZXRhLnRpdGxlKTsgLy8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHVzZXIgaGFzIGxvZ2dlZCBpbgoKICAgICAgICAgICAgaGFzVG9rZW4gPSBnZXRUb2tlbigpOwogICAgICAgICAgICBjb25zb2xlLmxvZygn44CQLi9zcmMvcGVybWlzc2lvbi5qc+OAkTHjgIHor7vlj5Z0b2tlbu+8micsIGhhc1Rva2VuKTsKCiAgICAgICAgICAgIGlmICghaGFzVG9rZW4pIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICghKHRvLnBhdGggPT09ICcvbG9naW4nKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaWYgaXMgbG9nZ2VkIGluLCByZWRpcmVjdCB0byB0aGUgaG9tZSBwYWdlCiAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgIHBhdGg6ICcvJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM1OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICBoYXNHZXRVc2VySW5mbyA9IHN0b3JlLmdldHRlcnMubmFtZTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+OAkC4vc3JjL3Blcm1pc3Npb24uanPjgJEy44CBdnVleCBzdGF0ZSB1c2VyLm5hbWUg77yaJywgX3R5cGVvZihoYXNHZXRVc2VySW5mbyksIGhhc0dldFVzZXJJbmZvKTsKCiAgICAgICAgICAgIGlmICghaGFzR2V0VXNlckluZm8pIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM1OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTc7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL2dldEluZm8nKTsKCiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBjb25zb2xlLmxvZygn44CQLi9zcmMvcGVybWlzc2lvbi5qc+OAkTPjgIHosIPnlKjnlKjmiLfkv6Hmga/mjqXlj6PvvIzojrflj5bmnIDmlrDnlKjmiLfkv6Hmga/vvJonLCByZXN1bHQpOwogICAgICAgICAgICByb2xlcyA9IHJlc3VsdC5yb2xlczsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+OAkC4vc3JjL3Blcm1pc3Npb24uanPjgJE044CB6I635Y+W55So5oi35omA5bGe6KeS6Imy77yM55Sf5oiQ6Lev55Sx6KGo77yaJywgcm9sZXMpOwogICAgICAgICAgICBzdG9yZS5kaXNwYXRjaCgncGVybWlzc2lvbi9nZW5lcmF0ZVJvdXRlcycsIHsKICAgICAgICAgICAgICByb2xlczogcm9sZXMKICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgdmFyIGFjY2Vzc1JvdXRlcyA9IHN0b3JlLmdldHRlcnMucGVybWlzc2lvbl9hZGRSb3V0ZXM7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+OAkC4vc3JjL3Blcm1pc3Npb24uanPjgJE344CB5L2/55SoIHJvdXRlci5hZGRSb3V0ZXJzIOaWueazlSDmt7vliqDlj6/orr/pl67nmoTot6/nlLHooajvvJonLCBhY2Nlc3NSb3V0ZXMpOwogICAgICAgICAgICAgIHJvdXRlci5hZGRSb3V0ZXMoYWNjZXNzUm91dGVzKTsgLy8g5Yqo5oCB5re75Yqg5Y+v6K6/6Zeu6Lev55Sx6KGoCgogICAgICAgICAgICAgIG5leHQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0byksIHt9LCB7CiAgICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlCiAgICAgICAgICAgICAgfSkpOyAvLyBoYWNr5pa55rOVIOehruS/nWFkZFJvdXRlc+W3suWujOaIkCAsc2V0IHRoZSByZXBsYWNlOiB0cnVlIHNvIHRoZSBuYXZpZ2F0aW9uIHdpbGwgbm90IGxlYXZlIGEgaGlzdG9yeSByZWNvcmQKICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzNTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI4OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDE3KTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMyOwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3VzZXIvcmVzZXRUb2tlbicpOwoKICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgIE1lc3NhZ2UuZXJyb3IoX2NvbnRleHQudDAgfHwgJ0hhcyBFcnJvcicpOwogICAgICAgICAgICBuZXh0KCIvbG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwoKICAgICAgICAgIGNhc2UgMzU6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzODsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgLyogaGFzIG5vIHRva2VuKi8KICAgICAgICAgICAgaWYgKHdoaXRlTGlzdC5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgICAgICAgICAgIC8vIGluIHRoZSBmcmVlIGxvZ2luIHdoaXRlbGlzdCwgZ28gZGlyZWN0bHkKICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gb3RoZXIgcGFnZXMgdGhhdCBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyBhcmUgcmVkaXJlY3RlZCB0byB0aGUgbG9naW4gcGFnZS4KICAgICAgICAgICAgICBuZXh0KCIvbG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDM4OgogICAgICAgICAgICBjb25zb2xlLmxvZygnPT0+6Lev55Sx6ZKp5a2Q57uT5p2fWy4vc3JjL3Blcm1pc3Npb24uanNdJyk7CgogICAgICAgICAgY2FzZSAzOToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzE3LCAyOF1dKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MiwgX3gzKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7CnJvdXRlci5hZnRlckVhY2goZnVuY3Rpb24gKCkgewogIC8vIGZpbmlzaCBwcm9ncmVzcyBiYXIKICBOUHJvZ3Jlc3MuZG9uZSgpOwp9KTs="},{"version":3,"sources":["D:/wwwroot/vue-admin-template/src/permission.js"],"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","to","from","next","console","log","start","document","title","meta","hasToken","path","done","hasGetUserInfo","getters","name","dispatch","result","roles","then","res","accessRoutes","permission_addRoutes","addRoutes","replace","catch","err","error","indexOf","afterEach"],"mappings":"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","sourcesContent":["import router from './router'\nimport store from './store'\nimport { Message } from 'element-ui'\nimport NProgress from 'nprogress' // progress bar\nimport 'nprogress/nprogress.css' // progress bar style\nimport { getToken } from '@/utils/auth' // get token from cookie\nimport getPageTitle from '@/utils/get-page-title'\n\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\n\nconst whiteList = ['/login'] // no redirect whitelist\n\nrouter.beforeEach(async(to, from, next) => {\n    console.log('==>路由钩子开始[./src/permission.js]')\n    // start progress bar\n    NProgress.start()\n\n    // set page title\n    document.title = getPageTitle(to.meta.title)\n\n    // determine whether the user has logged in\n    const hasToken = getToken()\n    console.log('【./src/permission.js】1、读取token：',hasToken)\n    if (hasToken) {\n        if (to.path === '/login') {\n            // if is logged in, redirect to the home page\n            next({ path: '/' })\n            NProgress.done()\n        } else {\n            const hasGetUserInfo = store.getters.name\n            console.log('【./src/permission.js】2、vuex state user.name ：',typeof (hasGetUserInfo),hasGetUserInfo)\n            if (hasGetUserInfo) {\n                next()\n            } else {\n                try {\n                    // async函数的执行会返回一个promise 对象，并且把内部的值进行promise的封装。\n                    // 如果promise对象通过then或catch方法又注册了回调函数，async函数执行完以后，注册的回调函数就会放到异步队列中，等待执行。\n                    // await的含义为等待。意思就是代码需要等待await后面的函数运行完并且有了返回结果之后，才继续执行下面的代码，同步的效果\n\n                    // get user info\n                    let result = await store.dispatch('user/getInfo' )\n                    console.log('【./src/permission.js】3、调用用户信息接口，获取最新用户信息：',result)\n\n                    const roles = result.roles\n                    console.log('【./src/permission.js】4、获取用户所属角色，生成路由表：',roles)\n\n                    store.dispatch('permission/generateRoutes', {roles} ).then((res) => {\n                        let accessRoutes = store.getters.permission_addRoutes\n                        console.log('【./src/permission.js】7、使用 router.addRouters 方法 添加可访问的路由表：',accessRoutes)\n\n                        router.addRoutes(accessRoutes) // 动态添加可访问路由表\n                        next({ ...to, replace: true }) // hack方法 确保addRoutes已完成 ,set the replace: true so the navigation will not leave a history record\n                    }).catch(err => {\n                        console.log(err);\n                    });\n\n                    next()\n                } catch (error) {\n                    // remove token and go to login page to re-login\n                    await store.dispatch('user/resetToken')\n                    Message.error(error || 'Has Error')\n                    next(`/login?redirect=${to.path}`)\n                    NProgress.done()\n                }\n            }\n        }\n    } else {\n        /* has no token*/\n\n        if (whiteList.indexOf(to.path) !== -1) {\n            // in the free login whitelist, go directly\n            next()\n        } else {\n            // other pages that do not have permission to access are redirected to the login page.\n            next(`/login?redirect=${to.path}`)\n            NProgress.done()\n        }\n    }\n    console.log('==>路由钩子结束[./src/permission.js]')\n})\n\nrouter.afterEach(() => {\n    // finish progress bar\n    NProgress.done()\n})\n"]}]}